/*! EasyRecipe Plus 3.2.2925 Copyright (c) 2014 BoxHill LLC */
!function(e){function t(t,a){var o,i,r=0;for(o=0;o<a.length;o++)i=b[a[o].id],"OK"===i.status&&(r+=i.nRecipes);e("#spnERSnImportRecipes").html(r),e("#spnERSnImportFiles").html(a.length),l.hide(),d.show()}function a(t,a,o){b[a.id]=e.parseJSON(o.response)}function o(){h.hide()}function i(){var i;switch(x&&(l.plupload("destroy"),u.html("")),i=e("#divERSImportFormats").find('input[name="rbERSImportSource"]:checked').val()){case"paprika":c=[{title:"Paprika (*.paprikarecipe)",extensions:"paprikarecipe"}];break;case"paprikas":c=[{title:"Paprika (*.paprikarecipes)",extensions:"paprikarecipes"}];break;case"mealmaster":c=[{title:"Meal-Master Format (*.mmf, *.mxp)",extensions:"mmf,mxp"}];break;case"mastercook":c=[{title:"MC 5+ Format (*.mx2)",extensions:"mx2"}];break;case"mastercookmxp":c=[{title:"Older MasterCook Format (*.mxp)",extensions:"mxp"}];break;case"yummysoup":c=[{title:"Yummy Soup Format (*.xml)",extensions:"xml"}];break;case"macgourmet":c=[{title:"MacGourmet Format (*.mgourmet3)",extensions:"mgourmet3"}];break;case"cookn":c=[{title:"Cook'n HTML (*.html)",extensions:"html"}];break;case"cookbookwiz":c=[{title:"Cookbook Wizard text (*.txt)",extensions:"txt"}];break;default:c=[]}l=e("#divERSImportUploader").plupload({runtimes:"html5,flash,silverlight,html4",url:ajaxurl,multipart_params:{action:"easyrecipeImport",source:i},filters:c,max_file_size:"10mb",chunk_size:"1mb",unique_names:!0,flash_swf_url:f.wpurl+"/wp-includes/js/plupload/plupload.flash.swf",silverlight_xap_url:f.wpurl+"/wp-includes/js/plupload/plupload.silverlight.xap"}),x=l.plupload("getUploader"),x.bind("UploadComplete",t),x.bind("FileUploaded",a),x.bind("BeforeUpload",o)}function r(){e("#divERSImportConfirm").hide(),l.plupload("destroy"),u.html(""),m.attr("checked",!1),x=null}function p(e){"OK"===e.status&&window.location.replace(f.editURL)}function s(){}function n(t){var a,o=[];switch(t.target.id){case"btnERSImportCreate":r(),h.hide(),d.hide(),k.show();for(a in b)b.hasOwnProperty(a)&&o.push(b[a].file);e.ajax(ajaxurl,{dataType:"json",data:{action:"easyrecipeCreate",files:o},type:"POST",success:p,error:s});break;case"btnERSImportCancel":r(),h.show(),d.hide()}}var l,m,c,u,d,h,k,f,x=null,b={};e(function(){var t;f=EASYRECIPE,t=e("#divERSImportButtons").on("click",n),e('input[type="button"]',t).button(),m=e("#divERSImportFormats").find('input[name="rbERSImportSource"]').on("change",i),u=e("#divERSImportUploader"),d=e("#divERSImportConfirm").hide(),h=e("#divERSImportSettings"),k=e("#divERSImportCreating").hide()})}(jQuery);