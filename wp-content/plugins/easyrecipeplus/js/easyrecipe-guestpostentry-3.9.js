/*! EasyRecipe Plus 3.2.2925 Copyright (c) 2014 BoxHill LLC */
window.EASYRECIPE=window.EASYRECIPE||{},function(e){function t(){var t,i,a,n,s,o,r,p,m,h,E,c,f=u.selection.getNode();if(t=e(".ERGPAlignment input:radio[name=rbERGPAlign]:checked").val(),i=e(".ERGPSize input:radio[name=rbERGPSize]:checked").val(),m=e.trim(g.val()),h=e.trim(v.val()),E=e.trim(G.val()),c=""===E?"none":"custom",k.isEntryDialog){for(i in P.meta.sizes)P.meta.sizes.hasOwnProperty(i)&&(P.meta.sizes[i].url=P.baseurl+P.meta.sizes[i].file);r={sizes:P.meta.sizes},p={size:i,align:t,link:c,linkUrl:E},k.insertUploadedImage(r,p)}else if("full"===i?(a=P.meta.width,n=P.meta.height,s=P.meta.file):(a=P.meta.sizes[i].width,n=P.meta.sizes[i].height,s=P.meta.sizes[i].file),o="aligncenter"===t?'<p style="text-align:center">':"",o+='<img class="'+t+" size-"+i+" wp-image-"+P.id+'"',o+=' title="'+m+'"',o+=' alt="'+h+'"',o+=' width="'+a+'"',o+=' height="'+n+'"',o+=' src="'+P.baseurl+s+'"',o+=" />",o+="aligncenter"===t?"</p>":"","#document"===f.nodeName&&(f=e("body",d)[0]),"BODY"===f.nodeName.toUpperCase())e(f).hasClass("mceContentBody")||(f=e("body",d)[0]),e(f).append("&nbsp;"+o);else{for(;f.parentNode&&"BODY"!==f.parentNode.nodeName.toUpperCase();)f=f.parentNode;f.parentNode?"DIV"===f.nodeName.toUpperCase()||"SPAN"===f.nodeName.toUpperCase()?e(f,d).after(o):e(f,d).before(o):(f=e("body",d)[0],e(f).append(o))}l.dialog("close")}function i(t,i){return m=!1,typeof tinyMCE!==O&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()&&(m=!0),m?(u=tinyMCE.activeEditor,d=i.editorId===p?e("#"+p+"_ifr").contents():e("#mce_fullscreen_ifr").contents(),void 0):(alert("You must use the Visual Editor to add or update an EasyRecipe"),void 0)}function a(){var t="html5,flash,silverlight,html4";f.hide(),E.hide(),s.show(),c.show(),R.text(""),g.val(""),v.val(""),G.val(""),l.dialog(A),Y.hide(),e("#ERGPplupload").html(""),plupload.VERSION&&plupload.ua&&"1.5.4"==plupload.VERSION&&plupload.ua.gecko&&(t="flash,silverlight,html4"),T=new plupload.Uploader({runtimes:t,browse_button:"btnERGPSelect",max_file_size:"10mb",container:"easyrecipeUpload",url:ajaxurl,flash_swf_url:k.wpurl+"/wp-includes/js/plupload/plupload.flash.swf",silverlight_xap_url:k.wpurl+"/wp-includes/js/plupload/plupload.silverlight.xap",multipart_params:{postID:h,action:"easyrecipeUpload"},filters:[{title:"Image files",extensions:"jpg,gif,png"}]}),T.init(),T.bind("FilesAdded",function(e,t){R.text("File: "+t[0].name),L.text(0),o.show(),s.hide(),f.show(),T.start()}),T.bind("UploadProgress",function(e,t){L.text(t.percent),o.progressbar("value",t.percent),100===t.percent&&Y.show()}),T.bind("Error",function(e){e.refresh()}),T.bind("FileUploaded",function(t,i,a){var n,l,s,o,r,d;P=e.parseJSON(a.response),c.hide(),E.show(),P.meta.sizes.thumbnail?(n=P.meta.sizes.thumbnail.file,o=P.meta.sizes.thumbnail.width,r=P.meta.sizes.thumbnail.height):(n=P.meta.file,r=P.meta.height,o=P.meta.width),D.attr("src",P.baseurl+n),r=130*r/o,D.css("top",Math.floor((140-r)/2)),P.postID&&e('.ERGuestPost form input[name="postID"]').val(P.postID);for(l in j)j.hasOwnProperty(l)&&(s=j[l],P.meta.sizes[l]?(s.attr(M,!1),s.next("span").text(" ("+P.meta.sizes[l].width+" x "+P.meta.sizes[l].height+")")):(s.attr(M,!0),s.next("span").text("")));j.medium.attr(M)?b.attr(B,!0):j.medium.attr(B,!0),w.text(" ("+P.meta.width+" x "+P.meta.height+")"),d=P.meta,e("#divERGPFIName").text(d.file),e("#divERGPFIDim").text(d.width+" x "+d.height),e("#divERGPFISize").text(d.filesize),Y.hide()}),T.refresh()}function n(){var t,i,a,n=!1;t=e("#spnERGPNameErr"),i=e("#spnERGPURLErr"),a=e("#spnERGPEmailErr"),t.text(""),i.text(""),i.text(""),""===e.trim(U.val())&&(t.text("You must enter your name"),n=!0),""===e.trim(I.val())?(a.text("You must enter your email"),n=!0):V.test(e.trim(I.val()))||(a.text("You must enter a valid email address"),n=!0),""===e.trim(C.val())&&(i.text("You must enter your website URL"),n=!0),n||(x.hide(),y.show())}var l,s,o,r,d,p,u,m,h,E,c,f,R,P,g,v,G,b,w,z,x,y,U,I,C,N,S,_,k,L,D,Y,A="open",O="undefined",F="click",T=null,j={},M="disabled",B="checked",V=/[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?/i;e(function(){var d;k=EASYRECIPE,l=e("#easyrecipeUpload"),z=e("#easyrecipeLinks"),l.dialog({autoOpen:!1,width:500,height:600,title:"Upload an image",modal:!0,appendTo:k.dialogs,dialogClass:"easyrecipeUpload",close:function(){e(".easyrecipeUpload").filter(function(){return""===e(this).text()}).remove(),T&&(T.destroy(),T=null)},open:function(){s.show(),o.progressbar("value",0)}}),e('input[type="button"]',z).button(),z.dialog({autoOpen:!1,width:480,title:"Insert/edit link",modal:!0,dialogClass:"easyrecipeLinks",appendTo:k.dialogs,close:function(){e(".easyrecipeLinks").filter(function(){return""===e(this).text()}).remove()},open:function(){}}),E=e("#divERGPUploaded"),c=e("#divERGPUploadContainer"),f=e("#divERGPUploading"),R=e("#divERGPFile"),g=e("#inpERGPTitle"),v=e("#inpERGPAltText"),G=e("#inpERGPLinkURL"),s=e("#btnERGPSelect").button(),_=e("#cbERGPLTarget"),S=e("#fldERGPLTitle"),N=e("#fldERGPLURL"),y=e("#divERGPPost"),x=e("#divERGPData"),U=e("#fldERGPName"),I=e("#fldERGPEmail"),C=e("#fldERGPURL"),j.thumbnail=e('.ERGPSize input[value="thumbnail"]'),j.medium=e('.ERGPSize input[value="medium"]'),j.large=e('.ERGPSize input[value="large"]'),b=e('.ERGPSize input[value="full"]'),w=b.next("span"),r=e("#btnERGPInsert").button().on(F,t),o=e("#divERGPProgress").progressbar().hide(),e(window).bind("guestpostloaded",i),e(".wp-media-buttons").hide(),h=e("#ERGPpostID").val(),p=e(".wp-editor-wrap").attr("id").replace(/^wp-(.*)-wrap$/gi,"$1"),e(".ERGuestPost .ERGPButton").button(),e("#btnERGPContinue").on(F,n),D=e("#imgERGPThumb"),L=e("#spnERGComplete"),Y=e("#divERGPSpinner"),k.isGuest=!0,k.doUpload=a,d=e("#inpERGPAuthor").val(),d&&(k.author='"'+d+'"')})}(jQuery);